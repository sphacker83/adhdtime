# Mobile-First UI Image Parity Plan

Last Updated: 2026-02-28

## Executive Summary
`MvpDashboard`의 UI를 `/docs/ui/main_ui.png` 기준으로 다시 맞추면서, 퀘스트 생성 동선을 전 탭 최우선 액션으로 올린다.
이번 라운드는 단순 스타일 보정이 아니라 홈 카드 정보 구조 재정의(현재 퀘스트/다음 미션/편집/삭제)와 청크 아이콘 데이터 모델 확장을 포함한다.
문서 선행 후 구현하며, 적용 범위는 `features/mvp` 내부로 한정한다.

## Hotfix Scope (2026-02-28, Responsive Breakage)
1. 상단 헤더가 좌우를 꽉 채우도록 폭 제한(`560px cap`) 제거
2. 하단 메뉴가 사라지는 체감 이슈 제거(모달/탭바 z-index 재정렬)
3. 하단 메뉴 아래 불필요 여백 제거(safe-area 중복 예약 정리)
4. 헤더 상단 불필요 공백 제거(패딩/갭/높이 재조정)
5. 현재 퀘스트의 `현재 미션` 라벨 제거
6. 현재 퀘스트의 `1개 +` 카운트 제거
7. `대기` 상태 칩(토큰) 제거

## Round 3 Critical Fixes (2026-02-28)
1. 헤더는 full-width를 유지하되 내부 요소 정렬(타이틀/달성도/시간줄)을 안정화한다.
2. 시간줄 텍스트 크기를 키우고 시간줄 하단 여백이 누적되지 않게 한다.
3. 하단 네비의 컨테이너 높이와 버튼 높이(52px) 불일치를 해소한다.
4. 현재 퀘스트가 없을 때 타이틀을 항상 `퀘스트 : 없음`으로 표시한다.
5. `캐릭터 상태` 타이틀을 카드 내부로 이동한다.
6. `대기 중인 퀘스트` 섹션도 카드 내부 구조로 통일한다.
7. 퀘스트 생성 플로팅을 좌하단으로 이동하고, `아이콘 상단/텍스트 하단` 세로 구조로 바꾼다.
8. dev-docs/dev-docs-update 규칙에 맞게 문서 인수인계를 최신화한다.
9. `docs/PRD.md`, `docs/DEVELOPMENT_PLAN.md`를 현재 구현 기준으로 동기화한다.

## Round 4 Navigation CTA Rebuild (2026-02-28)
1. 좌하단 플로팅 퀘스트 생성 버튼을 제거한다.
2. 하단 네비 중앙에 원형 `퀘스트 생성` CTA를 배치한다.
3. CTA가 네비 상단으로 돌출되는 `---^---` 시각 구조를 만든다.
4. 기존 퀘스트 생성 모달 동작(성공 시 닫힘)은 그대로 유지한다.
5. 기존 Phase 3의 플로팅 CTA 요구사항은 Round 4로 대체한다.

## Round 5 Bottom Bar Micro-Tuning (2026-02-28)
1. 하단 바 내부 공백(좌우/상하)을 줄여 탭 버튼 밀도를 높인다.
2. 중앙 CTA 원 크기/돌출 높이를 줄여 주변 탭과 시각 균형을 맞춘다.
3. 본문 하단 예약 여백(`shell padding-bottom`)을 축소해 빈 공간 체감을 줄인다.
4. 모달 오픈 시 하단 영역 안전 여백을 재보정한다.

## Round 6 Nav Typography + Quest Energy Ring (2026-02-28)
1. 하단 네비 탭 라벨 텍스트를 키운다.
2. 하단 네비의 영어 라벨을 완전히 제거한다.
3. 중앙 CTA 라벨을 `퀘스트`/`생성` 2줄로 강제 줄바꿈한다.
4. 현재 퀘스트 카드 우측 중앙에 큰 몬스터 아이콘을 배치한다.
5. 몬스터를 에너지 링서클 내부에 배치하고, 링은 타이머/청크 진행률에 따라 감소한다.
6. 청크 완료 시 링서클 에너지가 즉시 감소하도록 남은 시간 합산 로직을 반영한다.

## Round 7 Quest Card Layout Fine-Tune (2026-02-28)
1. 현재 퀘스트 카드의 상단 구조를 2열 2행으로 재배치한다.
2. `미션 제목 / 우측 수치(에너지%)` 배치를 고정한다.
3. `타이머 / 우측 링서클` 배치를 고정한다.
4. 메타 정보 블록(예상소요시간/마감시간/마감까지)은 기존 순서를 유지한다.
5. `퀘스트: 타이틀` 표기 형태를 적용한다.

## Round 8 Quest Card Emphasis (2026-02-28)
1. 퀘스트 카드 우측 링서클 영역을 고정 폭으로 확보해 존재감을 강화한다.
2. 몬스터 링서클 직경/몬스터 아이콘 크기를 확대한다.
3. 타이머 숫자를 더 굵고 크게 표시한다.
4. `미션 제목 / 에너지%`, `타이머 / 링서클` 배치는 유지하되 간격을 재정렬한다.

## New Requirements (12)
1. 플로팅 버튼에 `퀘스트 생성` 텍스트 명시
2. 플로팅 버튼을 우하단 고정으로 유지하고 모든 탭에서 노출
3. 퀘스트 생성 성공 시 팝업 자동 닫힘
4. 다음 미션에서 `대기` 상태 텍스트 제거
5. 다음 미션 앞에 미션별 아이콘 표시(생성 시 아이콘 확정)
6. 퀘스트 생성 기본 소요시간 표시를 `--`로 변경
7. 현재 퀘스트 카드에서 `#분 청크` 문구 제거
8. 현재 퀘스트 타이틀을 `퀘스트 : [퀘스트명]`으로 변경
9. 현재 퀘스트 카드에 `예상소요시간 / 마감시간 / 마감까지 남은 시간` 표시
10. 다음 미션 섹션을 `시작/일시정지/완료` 버튼 아래로 이동
11. 다음 미션에 예쁜 삭제 버튼 추가
12. 대기중 퀘스트 영역에 퀘스트/미션 수정 액션 추가
13. 헤더를 `/docs/ui/main_ui.png` 기준으로 재정합(오늘의 달성도 텍스트+링 위치)
14. 타이틀바 하단에 현재 날짜/요일/시간 표시

## Priority
1. `P0`: 플로팅 퀘스트 생성 UX(전 탭 노출, 라벨, 모달 닫힘)
2. `P0`: 헤더 정합(달성도 텍스트/링, 날짜/요일/시간 하단 배치)
3. `P0`: 현재 퀘스트 카드 정보 구조 재배치(타이틀, 메타, 다음 미션 위치)
4. `P0`: 다음 미션 아이콘/삭제 및 상태 텍스트 제거
5. `P1`: 대기중 퀘스트 편집 UX(퀘스트/미션 수정 진입)

## Technical Decisions
1. `TaskInputSection` 렌더 범위 확장:
- 홈 탭 조건문 밖으로 이동해 전 탭에서 플로팅 버튼 노출
2. 생성 성공 신호 전달:
- `handleGenerateTask`를 `Promise<boolean>`로 전환하고 성공 시 자식에서 모달 닫기
3. 미션 아이콘 모델:
- `Chunk.iconKey?: ChunkIconKey`를 도입하고 생성 경로(로컬/AI/템플릿/리청크)에서 유실 없이 매핑
4. 홈 카드 액션 재사용:
- 기존 `handleEditChunk`, `handleDeleteChunk`, `handleEditTaskTotalMinutes`를 홈 뷰에 연결
5. 헤더 정합 방식:
- `Final parity lock` 블록만 수정해 충돌 최소화
6. Round 4 CTA 방식:
- 모달 상태를 `MvpDashboard`로 승격해 네비 중앙 CTA와 연결
- `TaskInputSection`은 모달 렌더 전용으로 단순화
- 하단 네비는 좌/우 탭 그룹 + 중앙 돌출 CTA 3영역 레이아웃으로 재구성

## Implementation Phases
### Phase 1: 문서/기반선 확정
- plan/context/tasks를 12개 요구사항 기준으로 갱신
- 영향을 받는 파일/타입/테스트 범위 확정

### Phase 2: 데이터 모델 + 생성 경로
- `Chunk.iconKey` 타입/스토리지/청킹 매핑 추가
- 기본 아이콘 선택 함수 추가

### Phase 3: 플로팅 퀘스트 생성 UX
- 전 탭 플로팅 버튼 노출
- 버튼 라벨 `퀘스트 생성` + 아이콘 병기
- 생성 성공 시 모달 닫힘
- 기본 소요시간 표시 `--`

### Phase 4: 홈 카드/다음 미션 구조
- `퀘스트 : [이름]` 타이틀 반영
- `#분 청크` 제거
- 예상소요/마감/남은시간 표시
- 다음 미션 위치를 버튼 아래로 이동
- 다음 미션 아이콘 + 삭제 버튼 + 상태 텍스트 제거

### Phase 5: 대기중 퀘스트 수정 UX
- 퀘스트 수정 버튼 추가(우선 총시간/제목)
- 미션 수정 버튼 추가(액션/시간)

### Phase 6: 헤더 퍼펙트 정합 + 최종 검증
- 달성도 텍스트/링 위치 재정렬
- 타이틀바 하단 날짜/요일/시간 노출
- `typecheck/lint/test:mvp` + 수동 QA

## Risks & Mitigation
- 리스크: 아이콘 필드 도입 시 스토리지 역직렬화 깨짐
  - 대응: `iconKey` optional + storage validator 보강
- 리스크: 홈 뷰 액션 확장 시 실행 잠금 정책 누락
  - 대응: `isExecutionLocked` 전달 및 버튼 disabled 정책 통일
- 리스크: 헤더 높이 변경으로 본문 스크롤 시작점 충돌
  - 대응: `--header-height`/`.app top` 동시 보정

## Success Metrics
- 전 탭에서 `퀘스트 생성` CTA가 하단 네비 중앙 돌출 원형으로 노출된다.
- 생성 성공 시 모달이 닫히고, 실패 시 열린 상태로 오류를 확인할 수 있다.
- 현재 퀘스트 카드가 요구한 정보 구조(타이틀/예상소요/마감/남은시간/다음미션 위치)를 충족한다.
- 다음 미션에 아이콘/삭제가 동작하고 상태 텍스트가 사라진다.
- 헤더가 `/docs/ui/main_ui.png` 대비 핵심 위치(달성도 텍스트+링+하단 시계)를 충족한다.
- `npm run typecheck`, `npm run lint`, `npm run test:mvp` 통과.
